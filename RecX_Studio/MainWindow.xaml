<Window x:Class="RecX_Studio.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:RecX_Studio"
        xmlns:views="clr-namespace:RecX_Studio.Views"
        mc:Ignorable="d"
        Title="RecX_Studio" Height="800" Width="1200" MinHeight="650" MinWidth="800">
    
    
    <!-- пока хз для чего это, возможно надо будет удалить -->
    <Window.InputBindings>
        <KeyBinding Key="Add" Command="{Binding ZoomInCommand}" Modifiers="Control"/>
        <KeyBinding Key="OemPlus" Command="{Binding ZoomInCommand}" Modifiers="Control"/>
        <KeyBinding Key="Subtract" Command="{Binding ZoomOutCommand}" Modifiers="Control"/>
        <KeyBinding Key="OemMinus" Command="{Binding ZoomOutCommand}" Modifiers="Control"/>
        <KeyBinding Key="D0" Command="{Binding ZoomResetCommand}" Modifiers="Control"/>
        <KeyBinding Key="NumPad0" Command="{Binding ZoomResetCommand}" Modifiers="Control"/>
    </Window.InputBindings>
    
    <DockPanel>
        <!-- Контейнер для нижних панелей -->
        <Grid DockPanel.Dock="Top" Margin="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" MinHeight="300"/> <!-- Preview - основная область -->
                <RowDefinition Height="Auto"/> <!-- Панель масштабирования -->
                <RowDefinition Height="0.6*" MinHeight="150" /> <!-- Панели источников и управления -->
                <RowDefinition Height="25"/> <!-- Статусная панель -->
            </Grid.RowDefinitions>

            <!-- Область предпросмотра с дополнительными оптимизациями -->
            <Border Grid.Row="0" 
                    Background="#252526" 
                    Margin="0"
                    VerticalAlignment="Stretch">
                <Viewbox Stretch="Uniform" 
                         StretchDirection="Both"
                         VerticalAlignment="Center"
                         HorizontalAlignment="Center">
                    <Image x:Name="PreviewImage" 
                           Source="{Binding PreviewImage}" 
                           RenderOptions.BitmapScalingMode="HighQuality"
                           RenderOptions.EdgeMode="Aliased"
                           CacheMode="BitmapCache"
                           SnapsToDevicePixels="True"
                           UseLayoutRounding="True"/>
                </Viewbox>
            </Border>
            
            <!-- Панель масштабирования -->
            <Border Grid.Row="1" 
                    Background="#2D2D30" 
                    Height="30" 
                    CornerRadius="0"
                    Margin="0,0,0,0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <Button Content="-" 
                            Command="{Binding ZoomOutCommand}"
                            Style="{StaticResource ZoomButtonStyle}"
                            ToolTip="Уменьшить масштаб (Ctrl+-)"/>
                    
                    <Slider x:Name="ZoomSlider"
                            Minimum="0.5" 
                            Maximum="2.0" 
                            Value="{Binding ZoomLevel}"
                            Width="150"
                            Margin="10,0"
                            TickFrequency="0.1"
                            AutoToolTipPlacement="TopLeft"
                            AutoToolTipPrecision="1"
                            TickPlacement="BottomRight"/>
                    
                    <TextBlock Text="{Binding ZoomText}" 
                              Foreground="White"
                              VerticalAlignment="Center"
                              Width="40"
                              TextAlignment="Center"
                              Margin="5,0"/>
                    
                    <Button Content="+" 
                            Command="{Binding ZoomInCommand}"
                            Style="{StaticResource ZoomButtonStyle}"
                            ToolTip="Увеличить масштаб (Ctrl++)"/>
                    
                    <Button Content="100%" 
                            Command="{Binding ZoomResetCommand}"
                            Style="{StaticResource ZoomButtonStyle}"
                            ToolTip="Сбросить масштаб (Ctrl+0)"
                            Margin="10,0,0,0"/>
                </StackPanel>
            </Border>

            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" MinWidth="200"/>
                    <ColumnDefinition Width="0.5"/>
                    <ColumnDefinition Width="1*" MinWidth="250"/>
                </Grid.ColumnDefinitions>

                <views:SourcesPanel Grid.Column="0" DataContext="{Binding}"/>

                <GridSplitter Grid.Column="1" 
                              Width="5" 
                              HorizontalAlignment="Stretch"
                              Background="Transparent"
                              ShowsPreview="True"/>

                <views:ControlManagementPanel Grid.Column="2"/>
            </Grid>

            <!-- Статусная панель -->
            <views:StatusBarPanel Grid.Row="3" DataContext="{Binding}" Height="25"/>
        </Grid>
    </DockPanel>
</Window>
